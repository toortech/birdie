<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Birdie Bush Bandits â€“ Logos</title>
  <meta name="description" content="Official logos and branding materials for the Birdie Bush Bandits golf group.">
  <link rel="icon" type="image/svg+xml" href="bbb-logo.svg">
  <!-- Add Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Montserrat:wght@500;600;700&display=swap" rel="stylesheet">
  <!-- Global CSS -->
  <link rel="stylesheet" href="css/style.css">
  
  <!-- Core Modules -->
  <script src="js/config.js"></script>
  <script src="js/utils.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/db.js"></script>
  <script src="js/ui.js"></script>
  
  <style>
    /* Simple logo gallery styles */
    .logo-gallery {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 1.5rem;
      margin: 2rem 0;
    }
    
    .logo-item {
      border: 1px solid #eee;
      border-radius: 8px;
      padding: 1rem;
      text-align: center;
      background-color: white;
    }
    
    .logo-img-container {
      height: 150px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 0.75rem;
    }
    
    .logo-img {
      max-width: 100%;
      max-height: 100%;
    }
    
    .logo-name {
      font-size: 0.9rem;
      font-weight: bold;
      margin-bottom: 0;
    }
    
    /* Empty state */
    .empty-message {
      text-align: center;
      padding: 2rem;
      background-color: #f8f9fa;
      border-radius: 8px;
      margin: 2rem 0;
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
      .logo-gallery {
        grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      }
    }
    
    @media (max-width: 480px) {
      .logo-gallery {
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      }
    }
  </style>
</head>
<body>
  <!-- Authentication Protection -->
  <script>
    // Check if BBB_AUTH is loaded
    document.addEventListener('DOMContentLoaded', function() {
      // Wait for auth module to initialize
      setTimeout(function() {
        if (typeof BBB_AUTH !== 'undefined') {
          // If not authenticated and not on login page, redirect to login
          if (!BBB_AUTH.isAuthenticated && window.location.pathname.indexOf('login.html') === -1) {
            // Save the current URL to redirect back after login
            sessionStorage.setItem('redirectAfterLogin', window.location.pathname);
            window.location.href = 'login.html';
          }
        } else {
          console.error('BBB_AUTH module not found! Authentication check failed.');
        }
      }, 100); // Small delay to ensure modules are loaded
    });
  </script>
  
  <a href="#main" class="skip-link">Skip to main content</a>
  
  <main id="main"></main>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize modules
      BBB_AUTH.init({
        cloudflareEnabled: BBB_CONFIG.cloudflareEnabled
      });
      
      BBB_DB.init({
        useCloudflare: BBB_CONFIG.cloudflareEnabled,
        localStoragePrefix: 'bbb_'
      });
      
      // Create header
      const headerElements = BBB_UI.createHeader({
        fixed: true,
        showHomeLinkText: true
      });
      
      document.body.insertBefore(headerElements.header, document.body.firstChild);
      
      // Get main content element
      const main = document.getElementById('main');
      main.appendChild(headerElements.mainWrapper);
      
      // Create page content
      const mainContent = document.createElement('div');
      
      // Create page title
      const titleContainer = BBB_UI.createPageTitle({
        title: 'Birdie Bush Bandits',
        showFoundedText: true,
        showGolfballs: true
      });
      mainContent.appendChild(titleContainer);
      
      // Add page subtitle
      const subtitle = document.createElement('h2');
      subtitle.textContent = 'Club Logos';
      mainContent.appendChild(subtitle);
      
      // Create status message container
      const statusMessage = BBB_UI.createStatusMessage();
      mainContent.appendChild(statusMessage);
      
      // Add simple description
      const description = document.createElement('p');
      description.textContent = 'Here are the official Birdie Bush Bandits logos available for club use.';
      mainContent.appendChild(description);
      
      // Create logo gallery
      const logoGallery = document.createElement('div');
      logoGallery.className = 'logo-gallery';
      
      // Initialize empty message for no logos found
      const emptyMessage = document.createElement('div');
      emptyMessage.className = 'empty-message';
      emptyMessage.innerHTML = `
        <p>No logo files found yet. To add logos:</p>
        <ol>
          <li>Create a folder named "logos" in the project root</li>
          <li>Add image files to the folder (SVG, PNG, JPG, etc.)</li>
          <li>All image files will automatically appear here</li>
        </ol>
      `;
      
      // Add to content
      mainContent.appendChild(logoGallery);
      
      // Function to add logo to gallery
      function addLogo(path) {
        // Remove empty message if present
        if (document.querySelector('.empty-message')) {
          document.querySelector('.empty-message').remove();
        }
        
        const logoItem = document.createElement('div');
        logoItem.className = 'logo-item';
        
        const logoImgContainer = document.createElement('div');
        logoImgContainer.className = 'logo-img-container';
        
        const logoImg = document.createElement('img');
        logoImg.className = 'logo-img';
        logoImg.src = path;
        
        // Format the logo name from the filename
        const filename = path.split('/').pop();
        const name = formatLogoName(filename);
        logoImg.alt = name;
        
        logoImgContainer.appendChild(logoImg);
        
        const logoName = document.createElement('p');
        logoName.className = 'logo-name';
        logoName.textContent = name;
        
        logoItem.appendChild(logoImgContainer);
        logoItem.appendChild(logoName);
        logoGallery.appendChild(logoItem);
        
        return logoItem;
      }
      
      // Format logo name from filename
      function formatLogoName(filename) {
        // Remove extension
        const baseName = filename.split('.')[0];
        
        // Replace hyphens and underscores with spaces
        const nameWithSpaces = baseName.replace(/[-_]/g, ' ');
        
        // Capitalize first letter of each word
        return nameWithSpaces
          .split(' ')
          .map(word => word.charAt(0).toUpperCase() + word.slice(1))
          .join(' ');
      }
      
      // First add any images from the root that might exist (fallback)
      try {
        // Check if main logo exists
        fetch('bbb-logo.svg')
          .then(response => {
            if (response.ok) {
              addLogo('bbb-logo.svg');
            }
          })
          .catch(() => {
            console.log("Main logo not available");
          });
      } catch (e) {
        console.log("Error checking for root logo", e);
      }
      
      // Use fetch to list directory contents if possible
      // This will work if there's a server with directory listing enabled
      let foundAnyLogos = false;
      
      try {
        fetch('logos/')
          .then(response => response.text())
          .then(html => {
            // Parse the directory listing HTML
            const parser = new DOMParser();
            const doc = parser.parseFromString(html, 'text/html');
            
            // Find all links that might be image files
            const links = doc.querySelectorAll('a');
            const imageExtensions = ['.svg', '.png', '.jpg', '.jpeg', '.gif', '.webp'];
            
            // Filter for image files
            for (const link of links) {
              const href = link.getAttribute('href');
              
              // Check if it's an image file
              if (href && imageExtensions.some(ext => href.toLowerCase().endsWith(ext))) {
                addLogo(`logos/${href}`);
                foundAnyLogos = true;
              }
            }
            
            // If no logos found through directory listing, try specific checks
            if (!foundAnyLogos) {
              checkSpecificFiles();
            }
          })
          .catch(() => {
            // Directory listing failed or not enabled, try specific files
            checkSpecificFiles();
          });
      } catch (e) {
        // Fallback to checking specific files
        checkSpecificFiles();
      }
      
      // Function to check for specific files if directory listing fails
      function checkSpecificFiles() {
        // Common image extensions
        const extensions = ['svg', 'png', 'jpg', 'jpeg', 'gif', 'webp'];
        
        // Check files in the logos directory
        const checkFile = (filename) => {
          const img = new Image();
          img.onload = function() {
            addLogo(filename);
            foundAnyLogos = true;
          };
          img.src = filename;
        };
        
        // Try variations of file patterns
        for (const ext of extensions) {
          // Try with index numbers
          for (let i = 1; i <= 10; i++) {
            checkFile(`logos/logo${i}.${ext}`);
            checkFile(`logos/bbb-logo${i}.${ext}`);
          }
          
          // Try common names
          checkFile(`logos/logo.${ext}`);
          checkFile(`logos/bbb-logo.${ext}`);
          checkFile(`logos/logo-white.${ext}`);
          checkFile(`logos/bbb-logo-white.${ext}`);
          checkFile(`logos/icon.${ext}`);
          checkFile(`logos/badge.${ext}`);
        }
        
        // Check for logo files directly from GitHub URLs if possible
        // This might help if files are checked in but not yet served locally
        
        // After a delay, show empty message if no logos found
        setTimeout(() => {
          if (!foundAnyLogos && !document.querySelector('.logo-item')) {
            logoGallery.appendChild(emptyMessage);
          }
        }, 2000);
      }
      
      // Add content to main wrapper
      headerElements.mainWrapper.appendChild(mainContent);
    });
  </script>
</body>
</html>
